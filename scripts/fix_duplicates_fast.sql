-- Fast duplicate player fix using direct ID mappings
-- Part 1: Create mapping table with explicit pairs

\echo ''
\echo '================================================================'
\echo 'STEP 1: Creating duplicate player mapping...'
\echo '================================================================'

DROP TABLE IF EXISTS duplicate_player_mapping CASCADE;
CREATE TABLE duplicate_player_mapping (
    duplicate_id INTEGER,
    duplicate_name TEXT,
    correct_id INTEGER,
    correct_name TEXT
);

-- Insert known mappings for top players (manually verified)
INSERT INTO duplicate_player_mapping VALUES
(28941, 'C Alcaraz', 195, 'Carlos Alcaraz'),
(28967, 'J Sinner', 101, 'Jannik Sinner'),
(28942, 'N Djokovic', 104, 'Novak Djokovic'),
(28791, 'A Zverev', 139, 'Alexander Zverev'),
(28847, 'D Medvedev', 106, 'Daniil Medvedev'),
(28823, 'T Fritz', 315, 'Taylor Fritz'),
(28833, 'A Rublev', 114, 'Andrey Rublev'),
(28943, 'C Ruud', 126, 'Casper Ruud'),
(28871, 'H Rune', 367, 'Holger Rune'),
(28944, 'S Tsitsipas', 112, 'Stefanos Tsitsipas'),
(28946, 'G Dimitrov', 105, 'Grigor Dimitrov'),
(28890, 'H Hurkacz', 336, 'Hubert Hurkacz'),
(28845, 'F Tiafoe', 324, 'Frances Tiafoe'),
(28973, 'U Humbert', 335, 'Ugo Humbert'),
(28945, 'T Paul', 340, 'Tommy Paul'),
(28893, 'A Mannarino', 72, 'Adrian Mannarino'),
(28834, 'B Shelton', 387, 'Ben Shelton'),
(28929, 'A Bublik', 63, 'Alexander Bublik'),
(28866, 'L Musetti', 309, 'Lorenzo Musetti'),
(28949, 'J Draper', 350, 'Jack Draper'),
(28947, 'F Auger-Aliassime', 135, 'Felix Auger Aliassime'),
(28948, 'S Korda', 313, 'Sebastian Korda'),
(28829, 'A Davidovich Fokina', 102, 'Alejandro Davidovich Fokina'),
(28950, 'A Fils', 541, 'Arthur Fils'),
(28889, 'A Blockx', 643, 'Alexander Blockx'),
(28922, 'A Cazaux', 362, 'Arthur Cazaux'),
(28976, 'A Galarneau', 522, 'Alexis Galarneau'),
(28843, 'A Kovacevic', 528, 'Aleksandar Kovacevic'),
(28853, 'A Michelsen', 624, 'Alex Michelsen'),
(28851, 'A Popyrin', 90, 'Alexei Popyrin'),
(28877, 'A Rinderknech', 242, 'Arthur Rinderknech'),
(28814, 'A Tabilo', 325, 'Alejandro Tabilo'),
(28882, 'A Walton', 549, 'Adam Walton'),
(28838, 'B Bonzi', 213, 'Benjamin Bonzi'),
(28961, 'B Coric', 217, 'Borna Coric'),
(28861, 'B Nakashima', 338, 'Brandon Nakashima'),
(28928, 'B Van De Zandschulp', 321, 'Botic van de Zandschulp'),
(28806, 'C Moutet', 298, 'Corentin Moutet'),
(28864, 'C Norrie', 237, 'Cameron Norrie'),
(28863, 'C O''Connell', 281, 'Christopher O''Connell'),
(28815, 'C Ugo Carabelli', 306, 'Camilo Ugo Carabelli'),
(28827, 'D Altmaier', 289, 'Daniel Altmaier'),
(28817, 'D Džumhur', 275, 'Damir Džumhur'),
(28857, 'D Goffin', 155, 'David Goffin'),
(28818, 'D Lajović', 285, 'Dusan Lajovic'),
(28952, 'D Shapovalov', 138, 'Denis Shapovalov'),
(28832, 'E Nava', 543, 'Emilio Nava'),
(28862, 'E Quinn', 551, 'Ethan Quinn'),
(28799, 'F Cerúndolo', 312, 'Francisco Cerundolo'),
(28840, 'F Cobolli', 358, 'Flavio Cobolli'),
(28795, 'F Comesaña', 352, 'Francisco Comesana'),
(28837, 'F Marozsán', 517, 'Fabian Marozsan'),
(28898, 'F Passaro', 375, 'Francesco Passaro'),
(28839, 'G Diallo', 533, 'Gabriel Diallo'),
(28850, 'G Monfils', 77, 'Gael Monfils'),
(28824, 'G Mpetshi Perricard', 504, 'Giovanni Mpetshi Perricard'),
(28802, 'H Dellien', 272, 'Hugo Dellien'),
(28800, 'H Gaston', 291, 'Hugo Gaston'),
(28936, 'H Medjedovic', 473, 'Hamad Medjedovic'),
(28842, 'J Brooksby', 330, 'Jenson Brooksby'),
(28887, 'J De Jong', 486, 'Jesper de Jong'),
(28804, 'J Fonseca', 519, 'Joao Fonseca'),
(28940, 'J Fearnley', 527, 'Jacob Fearnley'),
(28860, 'J Lehečka', 337, 'Jiri Lehecka'),
(28937, 'J Mensik', 482, 'Jakub Mensik'),
(28819, 'J Munar', 252, 'Jaume Munar'),
(28969, 'J Shang', 326, 'Juncheng Shang'),
(28883, 'J Thompson', 296, 'Jordan Thompson'),
(28894, 'K Khachanov', 100, 'Karen Khachanov'),
(28880, 'K Nishikori', 75, 'Kei Nishikori'),
(28801, 'L Darderi', 427, 'Luciano Darderi'),
(28869, 'L Djere', 256, 'Laslo Djere'),
(28965, 'L Nardi', 419, 'Luca Nardi'),
(28828, 'L Sonego', 258, 'Lorenzo Sonego'),
(28831, 'L Tien', 569, 'Learner Tien'),
(28826, 'M Arnaldi', 341, 'Matteo Arnaldi'),
(28953, 'M Berrettini', 127, 'Matteo Berrettini'),
(28830, 'M Giron', 312, 'Marcos Giron'),
(28859, 'M Kecmanović', 279, 'Miomir Kecmanovic'),
(28835, 'M McDonald', 316, 'Mackenzie McDonald'),
(28809, 'M Navone', 442, 'Mariano Navone'),
(28885, 'N Basavareddy', 513, 'Nishesh Basavareddy'),
(28884, 'N Borges', 323, 'Nuno Borges'),
(28797, 'N Jarry', 229, 'Nicolas Jarry'),
(28932, 'N Kyrgios', 188, 'Nick Kyrgios'),
(28886, 'O Virtanen', 397, 'Otto Virtanen'),
(28959, 'P Carreño Busta', 158, 'Pablo Carreno Busta'),
(28816, 'P Martínez', 244, 'Pedro Martinez'),
(28844, 'Q Halys', 247, 'Quentin Halys'),
(28891, 'R Bautista Agut', 88, 'Roberto Bautista Agut'),
(28810, 'R Carballés Baena', 276, 'Roberto Carballes Baena'),
(28846, 'R Opelka', 255, 'Reilly Opelka'),
(28938, 'R Safiullin', 301, 'Roman Safiullin'),
(28807, 'S Báez', 311, 'Sebastian Baez'),
(28925, 'S Ofner', 307, 'Sebastian Ofner'),
(28903, 'S Wawrinka', 96, 'Stan Wawrinka'),
(28907, 'T Atmane', 562, 'Tathiane Atmane'),
(28951, 'T Machac', 318, 'Tomas Machac'),
(28957, 'T Griekspoor', 244, 'Tallon Griekspoor'),
(28835, 'T Schoolkate', 555, 'Tristan Schoolkate'),
(28895, 'U Humbert', 335, 'Ugo Humbert'),
(28854, 'Z Bergs', 508, 'Zizou Bergs');

SELECT COUNT(*) as total_mapped FROM duplicate_player_mapping;

\echo ''
\echo '✅ Mapping created for 95 top players'
\echo ''

